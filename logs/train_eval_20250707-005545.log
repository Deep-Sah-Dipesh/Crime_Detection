2025-07-07 00:55:45,432 - main - INFO - Starting training/evaluation script.
2025-07-07 00:55:45,432 - main - INFO - Using device: cuda
2025-07-07 00:55:45,432 - main - INFO - Scanning video directory for all clips: g:\Crime_Detection\Training\Videos
2025-07-07 00:55:45,550 - main - INFO - Found 3950 total video clips.
2025-07-07 00:55:45,550 - main - INFO - Total clips: 3950
2025-07-07 00:55:45,550 - main - INFO - Splitting data: Train (2765), Val (592), Test (593)
2025-07-07 00:55:46,319 - main - INFO - Actual Train samples: 2763, Val samples: 589, Test samples: 592
2025-07-07 00:55:46,319 - main - INFO - Train batches: 173, Val batches: 37, Test batches: 37
2025-07-07 00:55:47,759 - main - INFO - Model architecture:
MultimodalCrimeDetector(
  (text_embedder): Sequential(
    (0): Linear(in_features=768, out_features=256, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
  )
  (video_embedder): Sequential(
    (0): Linear(in_features=512, out_features=256, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
  )
  (audio_embedder): Sequential(
    (0): Linear(in_features=1024, out_features=256, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
  )
  (fusion_layer): Sequential(
    (0): Linear(in_features=768, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
  )
  (classifier): Linear(in_features=512, out_features=2, bias=True)
)
2025-07-07 00:55:47,759 - main - INFO - Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 1e-05
)
2025-07-07 00:55:47,759 - main - INFO - Loss function: CrossEntropyLoss()
2025-07-07 00:55:47,780 - main - INFO - Resuming training from epoch 15 with previous best validation loss 0.1437
2025-07-07 00:55:47,780 - main - INFO - Starting training loop...
2025-07-07 00:56:11,561 - main - INFO - Epoch [15/50], Batch [50/173], Loss: 0.0078, Batch Acc: 97.75%
2025-07-07 00:56:28,328 - main - INFO - Epoch [15/50], Batch [100/173], Loss: 0.2405, Batch Acc: 97.50%
2025-07-07 00:56:43,854 - main - INFO - Epoch [15/50], Batch [150/173], Loss: 0.0163, Batch Acc: 97.71%
2025-07-07 00:57:03,459 - main - INFO - Epoch 15 Training Summary: Avg Loss: 0.0717, Accuracy: 97.68%
2025-07-07 00:57:26,226 - main - INFO - Validation Results: Loss: 0.1525, Accuracy: 93.72%, Precision: 0.9360, Recall: 0.9392, F1: 0.9376, AUC-ROC: 0.9880
2025-07-07 00:57:26,226 - main - INFO - Epoch 15 finished in 98.45 seconds.
2025-07-07 00:57:26,226 - main - INFO - Early stopping patience: 1/10
2025-07-07 00:57:48,846 - main - INFO - Epoch [16/50], Batch [50/173], Loss: 0.0431, Batch Acc: 97.87%
2025-07-07 00:57:49,110 - main - INFO - Epoch [16/50], Batch [100/173], Loss: 0.0734, Batch Acc: 97.44%
2025-07-07 00:57:49,426 - main - INFO - Epoch [16/50], Batch [150/173], Loss: 0.1706, Batch Acc: 97.58%
2025-07-07 00:57:50,311 - main - INFO - Epoch 16 Training Summary: Avg Loss: 0.0747, Accuracy: 97.68%
2025-07-07 00:58:13,425 - main - INFO - Validation Results: Loss: 0.1491, Accuracy: 94.06%, Precision: 0.9394, Recall: 0.9426, F1: 0.9410, AUC-ROC: 0.9876
2025-07-07 00:58:13,425 - main - INFO - Epoch 16 finished in 47.20 seconds.
2025-07-07 00:58:13,425 - main - INFO - Early stopping patience: 2/10
2025-07-07 00:58:35,735 - main - INFO - Epoch [17/50], Batch [50/173], Loss: 0.0303, Batch Acc: 98.62%
2025-07-07 00:58:36,021 - main - INFO - Epoch [17/50], Batch [100/173], Loss: 0.0147, Batch Acc: 98.12%
2025-07-07 00:58:36,381 - main - INFO - Epoch [17/50], Batch [150/173], Loss: 0.0810, Batch Acc: 97.92%
2025-07-07 00:58:37,254 - main - INFO - Epoch 17 Training Summary: Avg Loss: 0.0633, Accuracy: 97.79%
2025-07-07 00:59:00,108 - main - INFO - Validation Results: Loss: 0.1685, Accuracy: 93.89%, Precision: 0.9577, Recall: 0.9189, F1: 0.9379, AUC-ROC: 0.9859
2025-07-07 00:59:00,108 - main - INFO - Epoch 17 finished in 46.68 seconds.
2025-07-07 00:59:00,108 - main - INFO - Early stopping patience: 3/10
2025-07-07 00:59:22,229 - main - INFO - Epoch [18/50], Batch [50/173], Loss: 0.0514, Batch Acc: 97.87%
2025-07-07 00:59:22,499 - main - INFO - Epoch [18/50], Batch [100/173], Loss: 0.3421, Batch Acc: 98.00%
2025-07-07 00:59:22,735 - main - INFO - Epoch [18/50], Batch [150/173], Loss: 0.2850, Batch Acc: 98.04%
2025-07-07 00:59:23,658 - main - INFO - Epoch 18 Training Summary: Avg Loss: 0.0601, Accuracy: 97.94%
2025-07-07 00:59:46,229 - main - INFO - Validation Results: Loss: 0.1638, Accuracy: 93.89%, Precision: 0.9514, Recall: 0.9257, F1: 0.9384, AUC-ROC: 0.9867
2025-07-07 00:59:46,229 - main - INFO - Epoch 18 finished in 46.12 seconds.
2025-07-07 00:59:46,229 - main - INFO - Early stopping patience: 4/10
2025-07-07 01:00:08,261 - main - INFO - Epoch [19/50], Batch [50/173], Loss: 0.0248, Batch Acc: 98.00%
2025-07-07 01:00:08,592 - main - INFO - Epoch [19/50], Batch [100/173], Loss: 0.2081, Batch Acc: 97.81%
2025-07-07 01:00:08,828 - main - INFO - Epoch [19/50], Batch [150/173], Loss: 0.0217, Batch Acc: 98.08%
2025-07-07 01:00:09,787 - main - INFO - Epoch 19 Training Summary: Avg Loss: 0.0538, Accuracy: 98.15%
2025-07-07 01:00:32,311 - main - INFO - Validation Results: Loss: 0.1803, Accuracy: 93.38%, Precision: 0.9105, Recall: 0.9628, F1: 0.9360, AUC-ROC: 0.9879
2025-07-07 01:00:32,311 - main - INFO - Epoch 19 finished in 46.08 seconds.
2025-07-07 01:00:32,311 - main - INFO - Early stopping patience: 5/10
2025-07-07 01:00:54,625 - main - INFO - Epoch [20/50], Batch [50/173], Loss: 0.0037, Batch Acc: 98.75%
2025-07-07 01:00:54,892 - main - INFO - Epoch [20/50], Batch [100/173], Loss: 0.0673, Batch Acc: 98.44%
2025-07-07 01:00:55,179 - main - INFO - Epoch [20/50], Batch [150/173], Loss: 0.1090, Batch Acc: 98.29%
2025-07-07 01:00:56,058 - main - INFO - Epoch 20 Training Summary: Avg Loss: 0.0531, Accuracy: 98.19%
2025-07-07 01:01:19,379 - main - INFO - Validation Results: Loss: 0.1883, Accuracy: 93.72%, Precision: 0.9609, Recall: 0.9122, F1: 0.9359, AUC-ROC: 0.9853
2025-07-07 01:01:19,379 - main - INFO - Epoch 20 finished in 47.07 seconds.
2025-07-07 01:01:19,379 - main - INFO - Early stopping patience: 6/10
2025-07-07 01:01:41,633 - main - INFO - Epoch [21/50], Batch [50/173], Loss: 0.0415, Batch Acc: 99.00%
2025-07-07 01:01:41,883 - main - INFO - Epoch [21/50], Batch [100/173], Loss: 0.0768, Batch Acc: 98.69%
2025-07-07 01:01:42,225 - main - INFO - Epoch [21/50], Batch [150/173], Loss: 0.0130, Batch Acc: 98.17%
2025-07-07 01:01:43,092 - main - INFO - Epoch 21 Training Summary: Avg Loss: 0.0582, Accuracy: 97.94%
2025-07-07 01:02:05,725 - main - INFO - Validation Results: Loss: 0.1688, Accuracy: 93.72%, Precision: 0.9512, Recall: 0.9223, F1: 0.9365, AUC-ROC: 0.9878
2025-07-07 01:02:05,725 - main - INFO - Epoch 21 finished in 46.35 seconds.
2025-07-07 01:02:05,725 - main - INFO - Early stopping patience: 7/10
2025-07-07 01:02:27,745 - main - INFO - Epoch [22/50], Batch [50/173], Loss: 0.0037, Batch Acc: 98.25%
2025-07-07 01:02:28,025 - main - INFO - Epoch [22/50], Batch [100/173], Loss: 0.0384, Batch Acc: 98.44%
2025-07-07 01:02:28,332 - main - INFO - Epoch [22/50], Batch [150/173], Loss: 0.1663, Batch Acc: 98.25%
2025-07-07 01:02:29,225 - main - INFO - Epoch 22 Training Summary: Avg Loss: 0.0535, Accuracy: 98.37%
2025-07-07 01:02:51,792 - main - INFO - Validation Results: Loss: 0.1695, Accuracy: 93.72%, Precision: 0.9481, Recall: 0.9257, F1: 0.9368, AUC-ROC: 0.9873
2025-07-07 01:02:51,792 - main - INFO - Epoch 22 finished in 46.07 seconds.
2025-07-07 01:02:51,792 - main - INFO - Early stopping patience: 8/10
2025-07-07 01:03:13,928 - main - INFO - Epoch [23/50], Batch [50/173], Loss: 0.0625, Batch Acc: 98.50%
2025-07-07 01:03:14,265 - main - INFO - Epoch [23/50], Batch [100/173], Loss: 0.0042, Batch Acc: 98.25%
2025-07-07 01:03:14,563 - main - INFO - Epoch [23/50], Batch [150/173], Loss: 0.0476, Batch Acc: 98.46%
2025-07-07 01:03:15,450 - main - INFO - Epoch 23 Training Summary: Avg Loss: 0.0401, Accuracy: 98.52%
2025-07-07 01:03:38,241 - main - INFO - Validation Results: Loss: 0.1857, Accuracy: 93.72%, Precision: 0.9111, Recall: 0.9696, F1: 0.9394, AUC-ROC: 0.9887
2025-07-07 01:03:38,241 - main - INFO - Epoch 23 finished in 46.45 seconds.
2025-07-07 01:03:38,241 - main - INFO - Early stopping patience: 9/10
2025-07-07 01:04:00,796 - main - INFO - Epoch [24/50], Batch [50/173], Loss: 0.0634, Batch Acc: 98.87%
2025-07-07 01:04:01,044 - main - INFO - Epoch [24/50], Batch [100/173], Loss: 0.0038, Batch Acc: 98.69%
2025-07-07 01:04:01,290 - main - INFO - Epoch [24/50], Batch [150/173], Loss: 0.0159, Batch Acc: 98.67%
2025-07-07 01:04:02,205 - main - INFO - Epoch 24 Training Summary: Avg Loss: 0.0405, Accuracy: 98.59%
2025-07-07 01:04:25,642 - main - INFO - Validation Results: Loss: 0.1882, Accuracy: 94.06%, Precision: 0.9251, Recall: 0.9595, F1: 0.9420, AUC-ROC: 0.9874
2025-07-07 01:04:25,642 - main - INFO - Epoch 24 finished in 47.40 seconds.
2025-07-07 01:04:25,642 - main - INFO - Early stopping patience: 10/10
2025-07-07 01:04:25,642 - main - INFO - Early stopping triggered at epoch 24. No improvement in validation loss for 10 epochs.
2025-07-07 01:04:25,642 - main - INFO - Training complete.
2025-07-07 01:04:25,642 - main - INFO - Evaluating on test set...
2025-07-07 01:04:49,294 - main - INFO - Test Results: Loss: 0.2115, Accuracy: 91.89%, Precision: 0.9130, Recall: 0.9254, F1: 0.9192, AUC-ROC: 0.9767
2025-07-07 01:04:49,294 - main - INFO - Final Test Set Metrics:
2025-07-07 01:04:49,294 - main - INFO -   Accuracy: 91.89%
2025-07-07 01:04:49,294 - main - INFO -   Precision: 0.9130
2025-07-07 01:04:49,294 - main - INFO -   Recall: 0.9254
2025-07-07 01:04:49,294 - main - INFO -   F1-Score: 0.9192
2025-07-07 01:04:49,294 - main - INFO -   AUC-ROC: 0.9767
2025-07-07 01:04:49,294 - main - INFO - Script finished.
